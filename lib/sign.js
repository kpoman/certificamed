const a0_0xb4a2=['\x0aPlataforma\x20','https://www.certificamed.com','Signature\x20request\x20ID\x201','crypto','fromDate','CAdES','getHeight','sizeInBytes','Adobe.PPKLite','catalog','getPdfHash:','get','-----BEGIN\x20PKCS7-----','LeftSquareBracket','replace','Widget','AcroForm','ok\x20signing\x20on\x20safeweb\x20!','getWidth','padStart','obj','register','saveAsBase64','getPage','charCodeAt','https://assinaturadigital.iti.gov.br/','copyBytesInto','array','size','Annots','debug','bytes','btoa','ajax','cryptojs','-----END\x20PKCS7-----','Arquivo\x20PDF','log','set','push','Sig','PDFArray','PDFArrayCustom','solutiSignHash:','application/json','context','Annot','ref','length','one','CharCodes','added\x20watermark\x20to\x20pdf:','documento\x20assinado\x20eletrÃ´nicamente','Bearer\x20','toString','Documento\x20solicitado\x20dentro\x20da\x20plataforma\x20com\x20assinatura\x20digital','load','stringify','bearer','Space','obtained','identification','POST','https://pscsafeweb.safewebpss.com.br/Service/Microservice/OAuth/api/v0/oauth/signature-icp','raw_signature','PDFString','padEnd','atob','withContext','PDFDocument','drawText','PDFName','sha256','addSigPlaceholder:','then','getPages','Signature1'];(function(_0x34a25f,_0xb4a204){const _0x1ce96d=function(_0x323d90){while(--_0x323d90){_0x34a25f['push'](_0x34a25f['shift']());}};_0x1ce96d(++_0xb4a204);}(a0_0xb4a2,0x141));const a0_0x1ce9=function(_0x34a25f,_0xb4a204){_0x34a25f=_0x34a25f-0x0;let _0x1ce96d=a0_0xb4a2[_0x34a25f];return _0x1ce96d;};function addSignedPdfIndicator(_0x4bdb22,_0x48a50b){var _0x1affe8=window['btoa'](_0x4bdb22),_0x5a625c=a0_0x1ce9('0xc');return new Promise(function(_0x2ef5ef,_0x4c1885){PDFLib['PDFDocument'][a0_0x1ce9('0x2b')](_0x1affe8)[a0_0x1ce9('0x3d')](function(_0x916458){let _0x1a55a2=_0x916458[a0_0x1ce9('0xa')](0x0),_0x4dc41a=_0x1a55a2[a0_0x1ce9('0x46')](),_0x19456b=_0x1a55a2[a0_0x1ce9('0x5')]();_0x1a55a2[a0_0x1ce9('0x39')](a0_0x1ce9('0x27'),{'x':0x37,'y':0x25,'width':0x50,'height':0x14,'size':0x3,'opacity':0.8,'lineHeight':0x4}),_0x1a55a2[a0_0x1ce9('0x39')](_0x48a50b,{'x':0x36,'y':0x22,'width':0x50,'height':0x14,'size':0x2,'opacity':0.1,'lineHeight':0x2}),_0x916458[a0_0x1ce9('0x9')]()[a0_0x1ce9('0x3d')](function(_0x3f8ee6){console[a0_0x1ce9('0x18')](a0_0x1ce9('0x26')),console['log'](_0x3f8ee6[a0_0x1ce9('0x23')],a0_0x1ce9('0x12')),_0x2ef5ef(window[a0_0x1ce9('0x36')](_0x3f8ee6));},function(_0x1f384d){console['error']('error\x20in\x20saveasbase64:'),console['error'](_0x1f384d),_0x4c1885(_0x1f384d);});},function(_0x1c8dd7){_0x4c1885(_0x1c8dd7);});});}function safewebSignPdf(_0x1e6c1b){return new Promise(function(_0x21b95e,_0x213788){var _0x4f57c9='';_0x4f57c9+=a0_0x1ce9('0x40')+friendly_name,keys=['provider',a0_0x1ce9('0x30'),a0_0x1ce9('0x2f')];for(k in keys){_0x4f57c9+='\x0a'+keys[k]+':\x20'+certificate_session[keys[k]];}addSignedPdfIndicator(_0x1e6c1b,_0x4f57c9)[a0_0x1ce9('0x3d')](function(_0x3c2f0f){bearer=certificate_session['bearer'],headers={'Authorization':'Bearer\x20'+bearer},data_base64=window[a0_0x1ce9('0x13')](_0x3c2f0f),$[a0_0x1ce9('0x14')]({'url':a0_0x1ce9('0x32'),'headers':headers,'type':a0_0x1ce9('0x31'),'contentType':a0_0x1ce9('0x1f'),'data':JSON[a0_0x1ce9('0x2c')]({'file':{'id':a0_0x1ce9('0x42'),'alias':a0_0x1ce9('0x17'),'content':data_base64,'signature_type':0x2,'signature_policy':0x0}}),'success':function(_0x19f145){console[a0_0x1ce9('0x18')](a0_0x1ce9('0x4')),_0x21b95e(_0x19f145);},'error':function(_0x143374){console['log']('trouble\x20signing\x20in\x20safeweb:'),console[a0_0x1ce9('0x18')](_0x143374),_0x213788(_0x143374);}});},function(_0x1ef242){_0x213788(_0x1ef242);});});}function addSigPlaceholder(_0x4e7df5){pages=_0x4e7df5[a0_0x1ce9('0x3e')]();const _0xc4d2a2=PDFLib[a0_0x1ce9('0x1d')][a0_0x1ce9('0x37')](_0x4e7df5[a0_0x1ce9('0x20')]);_0xc4d2a2[a0_0x1ce9('0x1a')](brp0),_0xc4d2a2[a0_0x1ce9('0x1a')](brp1),_0xc4d2a2[a0_0x1ce9('0x1a')](brp2),_0xc4d2a2['push'](brp3);let _0x4c3cae=_0x4e7df5['context']['obj']({'Type':a0_0x1ce9('0x1b'),'Filter':a0_0x1ce9('0x48'),'SubFilter':'ETSI.CAdES.detached','ByteRange':_0xc4d2a2,'Contents':pdf_sigdata,'ContactInfo':PDFLib[a0_0x1ce9('0x34')]['of']('suporte@empatizo.com'),'Location':PDFLib[a0_0x1ce9('0x34')]['of'](a0_0x1ce9('0x41')),'Reason':PDFLib[a0_0x1ce9('0x34')]['of'](a0_0x1ce9('0x2a')),'M':PDFLib['PDFString'][a0_0x1ce9('0x44')](new Date())}),_0xe0282a=_0x4e7df5[a0_0x1ce9('0x20')]['register'](_0x4c3cae),_0x114d1d=_0x4e7df5['context'][a0_0x1ce9('0x7')]({'Type':a0_0x1ce9('0x21'),'Subtype':a0_0x1ce9('0x2'),'FT':'Sig','Rect':[0x0,0x0,0x0,0x0],'V':_0xe0282a,'T':PDFLib['PDFString']['of'](a0_0x1ce9('0x3f')),'F':0x4,'P':pages[0x0][a0_0x1ce9('0x22')]}),_0x8d548c=_0x4e7df5[a0_0x1ce9('0x20')][a0_0x1ce9('0x8')](_0x114d1d);return pages[0x0]['node'][a0_0x1ce9('0x19')](PDFLib[a0_0x1ce9('0x3a')]['of'](a0_0x1ce9('0x10')),_0x4e7df5[a0_0x1ce9('0x20')][a0_0x1ce9('0x7')]([_0x8d548c])),_0x4e7df5[a0_0x1ce9('0x49')]['set'](PDFLib[a0_0x1ce9('0x3a')]['of'](a0_0x1ce9('0x3')),_0x4e7df5[a0_0x1ce9('0x20')]['obj']({'SigFlags':0x3,'Fields':[_0x8d548c]})),_0x4e7df5;}function getPdfHash(_0x50feea){return new Promise(function(_0xa37bf0,_0x53c241){let _0x209632=window[a0_0x1ce9('0x36')](_0x50feea),_0x2fa4df=_0x209632[a0_0x1ce9('0x23')],_0x2ec344=_0x209632['indexOf'](pdf_sigdata),_0x38cb9c=_0x2ec344+String(pdf_sigdata)[a0_0x1ce9('0x23')],_0x46d288=String(0x0)[a0_0x1ce9('0x6')](String(brp0)['length'],'0'),_0x3385c0=String(_0x2ec344)[a0_0x1ce9('0x6')](String(brp1)['length'],'0'),_0x30cadc=String(_0x38cb9c)['padStart'](String(brp2)['length'],'0'),_0x5499be=String(_0x2fa4df-_0x38cb9c)[a0_0x1ce9('0x6')](String(brp3)[a0_0x1ce9('0x23')],'0');_0x209632=_0x209632[a0_0x1ce9('0x1')](brp0,_0x46d288),_0x209632=_0x209632[a0_0x1ce9('0x1')](brp1,_0x3385c0),_0x209632=_0x209632[a0_0x1ce9('0x1')](brp2,_0x30cadc),_0x209632=_0x209632[a0_0x1ce9('0x1')](brp3,_0x5499be),pdf_sigdata_inner=String(pdf_sigdata);let _0x433a5c=_0x209632[a0_0x1ce9('0x1')](pdf_sigdata_inner,''),_0x2ce2a3=new KJUR[(a0_0x1ce9('0x43'))]['MessageDigest']({'alg':a0_0x1ce9('0x3b'),'prov':a0_0x1ce9('0x15')}),_0x46d8d7=_0x2ce2a3['digestHex'](b64nltohex(window['btoa'](_0x433a5c)));_0xa37bf0({'data':_0x209632,'digest':_0x46d8d7,'signable_data':_0x433a5c});});}function solutiSignHash(_0xbed421,_0x4ce9f3){return new Promise(function(_0x545df1,_0x243685){bearer=certificate_session[a0_0x1ce9('0x2d')],!_0x4ce9f3&&(_0x4ce9f3=a0_0x1ce9('0x45')),url='https://api.birdid.com.br/v0/oauth/signature',headers={'Authorization':a0_0x1ce9('0x28')+bearer,'Content-Type':a0_0x1ce9('0x1f'),'Accept':a0_0x1ce9('0x1f')},hashes=[{'id':0x1,'alias':a0_0x1ce9('0x24'),'hash':_0xbed421,'signature_format':_0x4ce9f3}],data={'hashes':hashes,'include_chain':!![]},$['ajax']({'url':url,'type':a0_0x1ce9('0x31'),'crossDomain':!![],'headers':headers,'data':JSON[a0_0x1ce9('0x2c')](data),'success':function(_0xa88c8b){_0x545df1(_0xa88c8b);},'error':function(_0x8507b8){_0x243685(_0x8507b8);}});});}function solutiSignPdf(_0x3146ea){return new Promise(function(_0x13a74f,_0x4fe132){pdf_data=window[a0_0x1ce9('0x13')](_0x3146ea)[a0_0x1ce9('0x1')]('\x0a',''),PDFLib[a0_0x1ce9('0x38')][a0_0x1ce9('0x2b')](pdf_data)['then'](_0x41e4f8=>addSigPlaceholder(_0x41e4f8))['then'](_0x4d8779=>{console['log'](a0_0x1ce9('0x3c'),_0x4d8779),_0x4d8779['saveAsBase64']({'useObjectStreams':![]})[a0_0x1ce9('0x3d')](function(_0x256f28){getPdfHash(_0x256f28)[a0_0x1ce9('0x3d')](function(_0x3612d9){console[a0_0x1ce9('0x11')](a0_0x1ce9('0x4a'),_0x3612d9),debug_digest=_0x3612d9['digest'],solutiSignHash(debug_digest)[a0_0x1ce9('0x3d')](_0x1adbea=>{console['debug'](a0_0x1ce9('0x1e'),_0x1adbea);let _0x2b5f3e=_0x1adbea['signatures'][0x0][a0_0x1ce9('0x33')]['replace'](a0_0x1ce9('0x4c'),'')[a0_0x1ce9('0x1')](a0_0x1ce9('0x16'),''),_0x3b4ff7=window[a0_0x1ce9('0x36')](_0x2b5f3e),_0x1b4d8b='';for(let _0x336f13=0x0;_0x336f13<_0x3b4ff7[a0_0x1ce9('0x23')];_0x336f13++){const _0x21693d=_0x3b4ff7[a0_0x1ce9('0xb')](_0x336f13)['toString'](0x10);_0x1b4d8b+=_0x21693d[a0_0x1ce9('0x23')]===0x2?_0x21693d:'0'+_0x21693d;}_0x1b4d8b=_0x1b4d8b['toUpperCase']()[a0_0x1ce9('0x35')](signature_length,'0'),_0x256f28=_0x3612d9['data']['replace'](pdf_sigdata,'<'+_0x1b4d8b+'>'),_0x13a74f(_0x256f28);},_0x9c6ee8=>_0x4fe132(_0x9c6ee8));});});});});}$(document)['ready'](function(){console['log']('patching\x20pdf-lib.js\x20for\x20empatizo\x20P4d3S\x20crap');class _0x69cca0 extends PDFLib[a0_0x1ce9('0x1c')]{static[a0_0x1ce9('0x37')](_0x5cde36){return new _0x69cca0(_0x5cde36);}['clone'](_0x103ad6){const _0x2a9b9d=_0x69cca0[a0_0x1ce9('0x37')](_0x103ad6||this['context']);for(let _0x98a885=0x0,_0x1001c0=this['size']();_0x98a885<_0x1001c0;_0x98a885++){_0x2a9b9d[a0_0x1ce9('0x1a')](this[a0_0x1ce9('0xe')][_0x98a885]);}return _0x2a9b9d;}[a0_0x1ce9('0x29')](){let _0x14bfc1='[';for(let _0x4f495e=0x0,_0x44f411=this[a0_0x1ce9('0xf')]();_0x4f495e<_0x44f411;_0x4f495e++){_0x14bfc1+=this[a0_0x1ce9('0x4b')](_0x4f495e)[a0_0x1ce9('0x29')]();if(_0x4f495e<_0x44f411-0x1)_0x14bfc1+='\x20';}return _0x14bfc1+=']',_0x14bfc1;}['sizeInBytes'](){let _0x23dacb=0x2;for(let _0x34aa35=0x0,_0x287cab=this['size']();_0x34aa35<_0x287cab;_0x34aa35++){_0x23dacb+=this[a0_0x1ce9('0x4b')](_0x34aa35)[a0_0x1ce9('0x47')]();if(_0x34aa35<_0x287cab-0x1)_0x23dacb+=0x1;}return _0x23dacb;}[a0_0x1ce9('0xd')](_0x3b82b0,_0x1750fc){const _0x2efbd3=_0x1750fc;_0x3b82b0[_0x1750fc++]=PDFLib[a0_0x1ce9('0x25')][a0_0x1ce9('0x0')];for(let _0x33338a=0x0,_0x497953=this['size']();_0x33338a<_0x497953;_0x33338a++){_0x1750fc+=this[a0_0x1ce9('0x4b')](_0x33338a)[a0_0x1ce9('0xd')](_0x3b82b0,_0x1750fc);if(_0x33338a<_0x497953-0x1)_0x3b82b0[_0x1750fc++]=PDFLib[a0_0x1ce9('0x25')][a0_0x1ce9('0x2e')];}return _0x3b82b0[_0x1750fc++]=PDFLib[a0_0x1ce9('0x25')]['RightSquareBracket'],_0x1750fc-_0x2efbd3;}}PDFLib[a0_0x1ce9('0x1d')]=_0x69cca0,brp0=PDFLib['PDFName']['of'](byterange_placeholder+'0'),brp1=PDFLib[a0_0x1ce9('0x3a')]['of'](byterange_placeholder+'1'),brp2=PDFLib['PDFName']['of'](byterange_placeholder+'2'),brp3=PDFLib[a0_0x1ce9('0x3a')]['of'](byterange_placeholder+'3'),pdf_sigdata=PDFLib['PDFHexString']['of']('A'['repeat'](signature_length));});