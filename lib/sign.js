const a0_0x2f56=['fromDate','padEnd','push','application/json','drawText','provider','solutiSignHash:','POST','https://api.birdid.com.br/v0/oauth/signature','obtained','Arquivo\x20PDF','documento\x20assinado\x20eletrÃ´nicamente','digestHex','error','get','obj','https://pscsafeweb.safewebpss.com.br/Service/Microservice/OAuth/api/v0/oauth/signature-icp','RightSquareBracket','suporte@empatizo.com','length','load','crypto','node','PDFArrayCustom','register','btoa','toUpperCase','digest','repeat','ETSI.CAdES.detached','array','getPage','-----END\x20PKCS7-----','set','sizeInBytes','PDFArray','PDFName','Adobe.PPKLite','raw_signature','identification','bytes','Bearer\x20','one','Space','replace','CAdES','ajax','sha256','Signature1','getPdfHash:','copyBytesInto','Widget','size','atob','PDFDocument','debug','signatures','getWidth','addSigPlaceholder:','cryptojs','stringify','https://assinaturadigital.iti.gov.br/','saveAsBase64','then','toString','padStart','CharCodes','Annot','PDFHexString','Sig','ready','bearer','indexOf','catalog','PDFString','LeftSquareBracket','context','MessageDigest','error\x20in\x20saveasbase64:','withContext','https://www.certificamed.com','getHeight','log','Signature\x20request\x20ID\x201'];(function(_0x5115ad,_0x2f5638){const _0x4672bc=function(_0x275834){while(--_0x275834){_0x5115ad['push'](_0x5115ad['shift']());}};_0x4672bc(++_0x2f5638);}(a0_0x2f56,0x1b8));const a0_0x4672=function(_0x5115ad,_0x2f5638){_0x5115ad=_0x5115ad-0x0;let _0x4672bc=a0_0x2f56[_0x5115ad];return _0x4672bc;};function addSignedPdfIndicator(_0x10b152,_0x35c5ca){var _0x3e403b=window['btoa'](_0x10b152),_0x407122=a0_0x4672('0x29');return new Promise(function(_0x32e5be,_0x2370ba){PDFLib[a0_0x4672('0x22')][a0_0x4672('0x0')](_0x3e403b)[a0_0x4672('0x2b')](function(_0x60e3dd){let _0x245f3d=_0x60e3dd[a0_0x4672('0xb')](0x0),_0x47e0eb=_0x245f3d[a0_0x4672('0x3d')](),_0x692ed=_0x245f3d[a0_0x4672('0x25')]();_0x245f3d[a0_0x4672('0x44')](a0_0x4672('0x4b'),{'x':0x37,'y':0x25,'width':0x50,'height':0x14,'size':0x3,'opacity':0.8,'lineHeight':0x4}),_0x245f3d[a0_0x4672('0x44')](_0x35c5ca,{'x':0x36,'y':0x22,'width':0x50,'height':0x14,'size':0x2,'opacity':0.1,'lineHeight':0x2}),_0x60e3dd['saveAsBase64']()[a0_0x4672('0x2b')](function(_0x33c745){console['log']('added\x20watermark\x20to\x20pdf:'),console['log'](_0x33c745[a0_0x4672('0x53')],a0_0x4672('0x14')),_0x32e5be(window['atob'](_0x33c745));},function(_0x1f6e42){console[a0_0x4672('0x4d')](a0_0x4672('0x3a')),console[a0_0x4672('0x4d')](_0x1f6e42),_0x2370ba(_0x1f6e42);});},function(_0xabd119){_0x2370ba(_0xabd119);});});}function safewebSignPdf(_0x2fc658){return new Promise(function(_0x193ade,_0x2db8b9){var _0x419f94='';_0x419f94+='\x0aPlataforma\x20'+friendly_name,keys=[a0_0x4672('0x45'),a0_0x4672('0x13'),a0_0x4672('0x49')];for(k in keys){_0x419f94+='\x0a'+keys[k]+':\x20'+certificate_session[keys[k]];}addSignedPdfIndicator(_0x2fc658,_0x419f94)[a0_0x4672('0x2b')](function(_0x5da1ed){bearer=certificate_session[a0_0x4672('0x33')],headers={'Authorization':a0_0x4672('0x15')+bearer},data_base64=window[a0_0x4672('0x5')](_0x5da1ed),$[a0_0x4672('0x1a')]({'url':a0_0x4672('0x50'),'headers':headers,'type':a0_0x4672('0x47'),'contentType':a0_0x4672('0x43'),'data':JSON[a0_0x4672('0x28')]({'file':{'id':a0_0x4672('0x3f'),'alias':a0_0x4672('0x4a'),'content':data_base64,'signature_type':0x2,'signature_policy':0x0}}),'success':function(_0x29c109){console['log']('ok\x20signing\x20on\x20safeweb\x20!'),_0x193ade(_0x29c109);},'error':function(_0x55c8ca){console['log']('trouble\x20signing\x20in\x20safeweb:'),console[a0_0x4672('0x3e')](_0x55c8ca),_0x2db8b9(_0x55c8ca);}});},function(_0x1e837b){_0x2db8b9(_0x1e837b);});});}function addSigPlaceholder(_0x15cdfa){pages=_0x15cdfa['getPages']();const _0x34f904=PDFLib[a0_0x4672('0x3')][a0_0x4672('0x3b')](_0x15cdfa['context']);_0x34f904[a0_0x4672('0x42')](brp0),_0x34f904[a0_0x4672('0x42')](brp1),_0x34f904[a0_0x4672('0x42')](brp2),_0x34f904[a0_0x4672('0x42')](brp3);let _0x5d614b=_0x15cdfa[a0_0x4672('0x38')]['obj']({'Type':a0_0x4672('0x31'),'Filter':a0_0x4672('0x11'),'SubFilter':a0_0x4672('0x9'),'ByteRange':_0x34f904,'Contents':pdf_sigdata,'ContactInfo':PDFLib[a0_0x4672('0x36')]['of'](a0_0x4672('0x52')),'Location':PDFLib[a0_0x4672('0x36')]['of'](a0_0x4672('0x3c')),'Reason':PDFLib[a0_0x4672('0x36')]['of']('Documento\x20solicitado\x20dentro\x20da\x20plataforma\x20com\x20assinatura\x20digital'),'M':PDFLib[a0_0x4672('0x36')][a0_0x4672('0x40')](new Date())}),_0x2dbe06=_0x15cdfa[a0_0x4672('0x38')][a0_0x4672('0x4')](_0x5d614b),_0x31455f=_0x15cdfa['context'][a0_0x4672('0x4f')]({'Type':a0_0x4672('0x2f'),'Subtype':a0_0x4672('0x1f'),'FT':'Sig','Rect':[0x0,0x0,0x0,0x0],'V':_0x2dbe06,'T':PDFLib[a0_0x4672('0x36')]['of'](a0_0x4672('0x1c')),'F':0x4,'P':pages[0x0]['ref']}),_0x1cb7cc=_0x15cdfa['context'][a0_0x4672('0x4')](_0x31455f);return pages[0x0][a0_0x4672('0x2')][a0_0x4672('0xd')](PDFLib[a0_0x4672('0x10')]['of']('Annots'),_0x15cdfa[a0_0x4672('0x38')][a0_0x4672('0x4f')]([_0x1cb7cc])),_0x15cdfa[a0_0x4672('0x35')][a0_0x4672('0xd')](PDFLib['PDFName']['of']('AcroForm'),_0x15cdfa[a0_0x4672('0x38')][a0_0x4672('0x4f')]({'SigFlags':0x3,'Fields':[_0x1cb7cc]})),_0x15cdfa;}function getPdfHash(_0x90fc67){return new Promise(function(_0x4488f4,_0x4a9f6a){let _0x112d7d=window[a0_0x4672('0x21')](_0x90fc67),_0x1eedac=_0x112d7d[a0_0x4672('0x53')],_0x299757=_0x112d7d[a0_0x4672('0x34')](pdf_sigdata),_0x374173=_0x299757+String(pdf_sigdata)[a0_0x4672('0x53')],_0x3df1a0=String(0x0)[a0_0x4672('0x2d')](String(brp0)[a0_0x4672('0x53')],'0'),_0x34924c=String(_0x299757)['padStart'](String(brp1)[a0_0x4672('0x53')],'0'),_0x4d4d7f=String(_0x374173)[a0_0x4672('0x2d')](String(brp2)[a0_0x4672('0x53')],'0'),_0xd5ef11=String(_0x1eedac-_0x374173)[a0_0x4672('0x2d')](String(brp3)[a0_0x4672('0x53')],'0');_0x112d7d=_0x112d7d[a0_0x4672('0x18')](brp0,_0x3df1a0),_0x112d7d=_0x112d7d['replace'](brp1,_0x34924c),_0x112d7d=_0x112d7d[a0_0x4672('0x18')](brp2,_0x4d4d7f),_0x112d7d=_0x112d7d['replace'](brp3,_0xd5ef11),pdf_sigdata_inner=String(pdf_sigdata);let _0x34f71d=_0x112d7d['replace'](pdf_sigdata_inner,''),_0x237794=new KJUR[(a0_0x4672('0x1'))][(a0_0x4672('0x39'))]({'alg':a0_0x4672('0x1b'),'prov':a0_0x4672('0x27')}),_0x57ad19=_0x237794[a0_0x4672('0x4c')](b64nltohex(window[a0_0x4672('0x5')](_0x34f71d)));_0x4488f4({'data':_0x112d7d,'digest':_0x57ad19,'signable_data':_0x34f71d});});}function solutiSignHash(_0x102770,_0x2c00e6){return new Promise(function(_0x5a9e4b,_0x4055d6){bearer=certificate_session['bearer'],!_0x2c00e6&&(_0x2c00e6=a0_0x4672('0x19')),url=a0_0x4672('0x48'),headers={'Authorization':'Bearer\x20'+bearer,'Content-Type':'application/json','Accept':'application/json'},hashes=[{'id':0x1,'alias':a0_0x4672('0x16'),'hash':_0x102770,'signature_format':_0x2c00e6}],data={'hashes':hashes,'include_chain':!![]},$[a0_0x4672('0x1a')]({'url':url,'type':a0_0x4672('0x47'),'crossDomain':!![],'headers':headers,'data':JSON[a0_0x4672('0x28')](data),'success':function(_0x401818){_0x5a9e4b(_0x401818);},'error':function(_0x43eda7){_0x4055d6(_0x43eda7);}});});}function solutiSignPdf(_0x4a0fd4){return new Promise(function(_0x1717fa,_0x2beb22){pdf_data=window['btoa'](_0x4a0fd4)[a0_0x4672('0x18')]('\x0a',''),PDFLib['PDFDocument'][a0_0x4672('0x0')](pdf_data)[a0_0x4672('0x2b')](_0x1d4d0a=>addSigPlaceholder(_0x1d4d0a))['then'](_0x31c6d0=>{console[a0_0x4672('0x3e')](a0_0x4672('0x26'),_0x31c6d0),_0x31c6d0[a0_0x4672('0x2a')]({'useObjectStreams':![]})[a0_0x4672('0x2b')](function(_0x393c46){getPdfHash(_0x393c46)[a0_0x4672('0x2b')](function(_0x4ff9fc){console[a0_0x4672('0x23')](a0_0x4672('0x1d'),_0x4ff9fc),debug_digest=_0x4ff9fc[a0_0x4672('0x7')],solutiSignHash(debug_digest)[a0_0x4672('0x2b')](_0x34118f=>{console[a0_0x4672('0x23')](a0_0x4672('0x46'),_0x34118f);let _0x48c116=_0x34118f[a0_0x4672('0x24')][0x0][a0_0x4672('0x12')][a0_0x4672('0x18')]('-----BEGIN\x20PKCS7-----','')['replace'](a0_0x4672('0xc'),''),_0x44dc4a=window[a0_0x4672('0x21')](_0x48c116),_0x522c83='';for(let _0x5c97ed=0x0;_0x5c97ed<_0x44dc4a[a0_0x4672('0x53')];_0x5c97ed++){const _0x38867d=_0x44dc4a['charCodeAt'](_0x5c97ed)[a0_0x4672('0x2c')](0x10);_0x522c83+=_0x38867d[a0_0x4672('0x53')]===0x2?_0x38867d:'0'+_0x38867d;}_0x522c83=_0x522c83[a0_0x4672('0x6')]()[a0_0x4672('0x41')](signature_length,'0'),_0x393c46=_0x4ff9fc['data']['replace'](pdf_sigdata,'<'+_0x522c83+'>'),_0x1717fa(_0x393c46);},_0x320247=>_0x2beb22(_0x320247));});});});});}$(document)[a0_0x4672('0x32')](function(){console[a0_0x4672('0x3e')]('patching\x20pdf-lib.js\x20for\x20empatizo\x20P4d3S\x20crap');class _0x487d8a extends PDFLib[a0_0x4672('0xf')]{static['withContext'](_0x413274){return new _0x487d8a(_0x413274);}['clone'](_0x49b705){const _0x3d21d2=_0x487d8a[a0_0x4672('0x3b')](_0x49b705||this[a0_0x4672('0x38')]);for(let _0x329b95=0x0,_0x41b451=this['size']();_0x329b95<_0x41b451;_0x329b95++){_0x3d21d2[a0_0x4672('0x42')](this[a0_0x4672('0xa')][_0x329b95]);}return _0x3d21d2;}['toString'](){let _0x3f8c23='[';for(let _0x48708a=0x0,_0x3ec8e5=this[a0_0x4672('0x20')]();_0x48708a<_0x3ec8e5;_0x48708a++){_0x3f8c23+=this[a0_0x4672('0x4e')](_0x48708a)[a0_0x4672('0x2c')]();if(_0x48708a<_0x3ec8e5-0x1)_0x3f8c23+='\x20';}return _0x3f8c23+=']',_0x3f8c23;}[a0_0x4672('0xe')](){let _0x358458=0x2;for(let _0x18f224=0x0,_0x36fa6a=this[a0_0x4672('0x20')]();_0x18f224<_0x36fa6a;_0x18f224++){_0x358458+=this['get'](_0x18f224)['sizeInBytes']();if(_0x18f224<_0x36fa6a-0x1)_0x358458+=0x1;}return _0x358458;}['copyBytesInto'](_0x355286,_0x2823f9){const _0x419014=_0x2823f9;_0x355286[_0x2823f9++]=PDFLib[a0_0x4672('0x2e')][a0_0x4672('0x37')];for(let _0x581a6f=0x0,_0x5b2425=this[a0_0x4672('0x20')]();_0x581a6f<_0x5b2425;_0x581a6f++){_0x2823f9+=this[a0_0x4672('0x4e')](_0x581a6f)[a0_0x4672('0x1e')](_0x355286,_0x2823f9);if(_0x581a6f<_0x5b2425-0x1)_0x355286[_0x2823f9++]=PDFLib['CharCodes'][a0_0x4672('0x17')];}return _0x355286[_0x2823f9++]=PDFLib['CharCodes'][a0_0x4672('0x51')],_0x2823f9-_0x419014;}}PDFLib[a0_0x4672('0x3')]=_0x487d8a,brp0=PDFLib[a0_0x4672('0x10')]['of'](byterange_placeholder+'0'),brp1=PDFLib[a0_0x4672('0x10')]['of'](byterange_placeholder+'1'),brp2=PDFLib['PDFName']['of'](byterange_placeholder+'2'),brp3=PDFLib['PDFName']['of'](byterange_placeholder+'3'),pdf_sigdata=PDFLib[a0_0x4672('0x30')]['of']('A'[a0_0x4672('0x8')](signature_length));});